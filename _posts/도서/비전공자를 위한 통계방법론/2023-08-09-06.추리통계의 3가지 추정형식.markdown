---
layout: post
title: 추리통계의 3가지 추정형식
date: 2023-08-09 19:21:23 +0900
category: statistics 
use_math: true
---
# 비전공자를 위한 통계방법론    
<br>
표본데이터를 사용해 특정한 모집단 모수를 추정하는 세가지 형식으로  
점추정과 구간추정 가설검증이 있다.  
<br>
> 점추정  

모집단 모수의 점추정치는 그에 대응되는 표본통계량의 값(표본통계치)가 된다.  

추정량(estimator): 표본이 추출되기 전에 값이 알려지지 않은 표본통계량으로 모수를 추정하기 위한 것이다.  
추정치: 표본이 추출된 후 표본자료를 추정량에 대입해 수치로 계산된 추정량의 값이다.  
ex)표본평균은 모집단 평균에 대한 추정량이고  
표본을 추출한 뒤 표본평균을 계산해 얻은 값은 모집단 평균에 대한 추정치가 된다.
<br>  
표본통계량: 표본이 추출되기 전 값이 알려지지 않은 상태를 의미한다.  
*표본통계치: 현 책에서 표본이 추출된 후 표본자료를 표본통계량 공식에 넣어 수치로 계산된 표본통계량의 값을 나타내는 용어로 사용한다.
<br>  
무작위로 뽑은 하나의 표본에서 얻은 표본통계치는 다른 무작위 표본에서 얻은 표본통계치와 동일한 값을 가질것으로 기대하기 어렵다.  
모집단을 대표할 수 있는 하나의 무작위 표본에서 계산한 표본통계치는 해당 표본통계량의 확률분포상에 있는 무수히 많은 값들 중 하나일 뿐이다.  
경우에 따라 하나의 표본에서 얻은 통계량은 모집단의 통계량과 가까울수도 상당히 차이가 클 수도 있다.  
따라서 하나의 표본에서 얻은 점추정치를 제시할 때에는 새당 점추정치의 정확도를 나타내는 정보(점추정치)들이  
표본분포의 중앙값에 해당하는 모집단 모수로부터 얼마나 널리 흩어져 있는지를 나타내는 정보를 함께 제공해야 한다.  
표본분포가 정규분포등과 같이 좌우대칭의 확률분포를 따르는 표본통계량(표본평균, 표본비율 등)의 경우 그 정보를 담고 있는 지표가 표본오차(SE)다.
<br>  
추정량이 좋은 추정량인지를 판단하는 기준은 대표적으로 불편성, 효율성, 일치성이 있다.  
불편(unbiased)추정량: 이론적으로 해당 추정량의 기대값이 모집단 모수의 값과 같게 되는 추정량이다.  
효율(efficient)추정량: 불편추정량들 중에서 분산값이 가장 작은 추정량이다.  
표본통계량의 분산값이 가장 작다는 것은 그것의 표본오차가 가장 작다는 의미로 표본통계량의 예측정확도가 커진다는 의미이다.  
일치(consistent)추정량:이론적으로 불편추정량의 조건을 충족하는 추정량이 존재하지 않을 경우 대안이 될 만한 추정량들 중에서  
표본의 크기 n이 무한히 증가함에 따라 모집단 모수에 상응하는 표본통계량이 모집단 모수에 일치하게 되는 추정량을 가리킨다.
<br>  
> 구간추정  

구간추정: 모집단 모수가 취할 수 있는 값의 범위를 계산해서 제시하는 형식이다.  
ex)일정한 신뢰수준(예를 들면 95%)에서 모집단의 평균값은 하한값 a와 상한값 b 사이의 어떤 값일 것이다.  
모집단 모수가 취할 수 있는 값의 범위인 "신뢰구간"을 계산해 제시하는 형식이다.
<br>  
표본평균을 표준화한 또 하나의 확률변수 Z는 기대값이 0이고 표본오차가 1인 표준정규분포를 따른다.
<br>  
연구자가 표본에서 얻은 하나의 표본평균값은 표본분포를 구성하고 있는 무수히 많은 표본평균값들   
중에서 무작위로 뽑힌 하나의 값이라 볼 수 있고, 그 값을 표준화한 것 역시 표준정규분포를 구성하고  
있는 무수히 많은 표본평균값들 중 하나라고 볼 수 있다. 그 값을 표준화한 것 역시 표준정규분포를  
구성하고 있는 무수히 많은 값들 중에서 무작위로 뽑힌 하나의 값이라 볼 수 있다.
<br>  
연구자가 하나의 표본에서 얻은 표본평균값 $\overline{x}$가 모집단 평균 $\mu$를 중심값으로 한 표본분포로부터  
뽑혀나왔을 확률이 95% 정도 되려면 $\overline{x}$가 얼마만한 크기의 값이어야 할까?  
이에 대한 답변은 표본평균 $\overline{x}$를 표준화한 Z를 기준으로 볼 때 표준정규분포상에서 Z가 가운데  
0.95부분에 속한 값이어야 한다.
<br>  
표본평균의 표본오차(SE)가 $\frac{\sigma}{\sqrt{n}}$인 점을 이용한다면 표본평균  $\overline{x}$를 표준화한  
뒤 질문에 대한 답을 확률식으로 표현하면 다음과 같다.  
$P[-Z_{0.025}\leq \frac{\overline{x}-\mu}{\sigma/\sqrt{n}}\leq-Z_{0.025} ]$
<br>    
이를 $\mu$를 중심으로 재 정의한다면 다음과 같이 재정렬된다.  
$P[\overline{x}-Z_{0.025}\cdot \frac{\sigma}{\sqrt{n}}\leq \mu\leq \overline{x}+Z_{0.025}\cdot \frac{\sigma}{\sqrt{n}}]$
<br>    
또한 95% 신뢰수준을 $100(1-\alpha)%$로 일반화해 $\mu$의 신뢰구간을 표현하면 다음과 같다.   
$\overline{x}-Z_{\alpha/2}\cdot SE \leq \mu \leq \overline{x}+Z_{\alpha/2}\cdot SE$  
**여기서 $z_{\alpha/2}$는 표준정규분포의 특성을 갖는 확률분포에서 오른쪽 꼬리부분의 면적이 $\alpha/2$가**  
**되게하는 경계값을 나타내고, $\alpha$는 유의수준으로 이 추정의 결론이 틀려도 연구자가 감내하겠다는 확률이다.**  
**유의수준의 여집합 확률로 $1-\alpha$는 추정의 결론이 옳을 것이라는 확신의 정도인 신뢰수준을 의미한다.**  
SE는 해당 표본통계량의 표본오차를 의미한다.
<br>    
다만 위의 표본오차 공식속에 있는 모집단 표준편차$\sigma$는 그 값을 알 수 없기 때문에  
표본 표준편차s로 대체해 표본오차값을 계산하고 이는 표준정규분포가 아닌 t분포를 따르게 된다.
t분포를 따르는 신뢰구간은 다음과 같다.    
$\overline{x}-t_{\alpha/2}\cdot SE \leq \mu \leq \overline{x}+t_{\alpha/2}\cdot SE$
<br>  
이론적 표본오차 공식 속에 포함된 모집단의 통계량 값은 알 수 없다.  
따라서 대신에 불편추정치인 표본통계량을 사용해야 하는 상황은  
표본통계량의 표본 분포가 정규분포의 특성을 갖는 경우에 해당된다.
<br>  
표본통계량의 표본분포가 좌우대칭의 정규분포를 따를 때(표본평균, 표본비율, 두 표본의 평균차, 두 표본의 비율차,  
표본상관계수, 표본회귀계수 등의 표본분포가 여기에 해당된다.) 모집단 모수의 $100(1-\alpha)%$는 다음의 공식을 따른다.  
점추정치$-{t_{\alpha/2}}\cdot SE \leq$모수$\leq$점추정치$+{t_{\alpha/2}}\cdot SE$
<br>  
이 때 신뢰구간의 상한값과 하한값을 정하는 이 공식에서 표본통계치는 연구자가 하나의 표본을 확보해 계산한 값으로 연구자가 임의로 키우거나  
줄일 수 없는 값이다. $t_{2/\alpha}$ 또한 연구자가 유의수준$\alpha$값을 정하면 그 크기가 확정되는 값이다.  
반면 표본통계량의 표본오차(SE)는 표본의 수 n을 조절해 연구자가 임의로 키우거나 줄일 수 있다.  
$P[-Z_{0.025}\leq \frac{\overline{x}-\mu}{\sigma/\sqrt{n}}\leq-Z_{0.025} ] $
<br>  
표본의 수가 커지면 표본오차가 작아지고 모집단 모수의 신뢰구간이 작아진다.  
일정한 신뢰수준에서 모집단 모수의 신뢰구간이 작아진다는 것은 그만큼 예측의 정확도가 높아진다는 의미이다.  
따라서 표본의 크기를 키우는 것이 좋다.
<br>  
구간추정 시 신뢰수준에서 모수값이 취할 구간은 연구자가 설정한다.
<br>  
**표준편차(standard deviaton)와 표준오차(standard error//SE)는 다른 것이다.**  
표준편차는 모집단의 분포가 얼마나 퍼져있는가를 서술하는 개념이다.  
$\sigma = \sqrt{\frac{\sum(x_n-\mu)^2}{N}}$  
표준오차는 표본통계량의 표준 편차를 의미하며 평균의 추정치에 대한 불확실한 정도를 수치화한 것이다.  
모집단에서 샘플을 여러번 뽑아 각 샘플마다 평균을 구했을 때 해당 평균들의 표준편차로  
이는 표본이 모집단에서 얼마나 멀리 떨어져 있는지를 나타내는 지표이다.  
표본 표준편차$s_x(SD) = \sqrt{\frac{1}{N-1}\sum_{i=1}^{N}(x_i-\overline{x})^2}$  
표본평균의 표준오차$(SE)=\frac{s_x}{\sqrt{n}}$  
표본이 매번 추출될 때마다 값이 바뀌기 때문에 표본통계량은 매번 그 값에 오차가 있다.    
표본평균의 표준오차는 확률변수인 표본평균이 중심극한정리에 의해 모평균을 중심으로 종모양의 확률분포를  
나타내는데 이 확률분포의 표준편차를 의미한다. 즉 **표본평균의 표준편차**이다.  
**표준화라고 하는 것은 확률변수의 단위를 표준편차로 하는것으로 표준편차를 1로 만드는 변수변환이다.**
<br>  
현재 스터디한 부분은 표본통계량의 표본분포가 좌우대칭인 정규분포인 경우에 국한해 구간추정치를 구하는 방법이다.  
표본통계량의 표본분포가 좌우대칭이 아닌 카이제곱 분포나 F분포의 경우 모집단 모수의 구간추정치(신뢰구간)을 구할 땐  
모집단 분산의 구간추정치나 두 모집단 분산비를 구해서 확인한다.
<br>  
점추정치$\pm t_{\alpha/2}\cdot SE$가 모집단 모수의 신뢰구간 상하 경계값이 되는 직관적인 이유  64P 참조  
<br>  
신뢰수준 95%(=유의수준 0.05)에서 모집단 평균이 취할 수 있는 신뢰구간을 구하는 경우를 상정해본다.  
표본평균은 모집단 평균을 추정하기 위해 하나의 표본에서 얻은 점추정치이다.
<br>    
> 가설검증 $\pm t_{a/2} \cdot SE $가 모집단 모수의 신뢰구간 상/하 경계값이 되는 직관적인 이유  
64-66p 참조   
  
신뢰수준 95%(유의수준 0.05)에서 모집단 평균이 취할 수 있는 신뢰구간을 구하는 경우를 상정해본다.  
표본평균 $\overline{x}$은 모집단 평균$\mu$을 추정하기 위해 하나의 표본에서 얻은 점추정치이다.  
여기서 표본분포의 중앙값이 모집단 평균 $\mu$이 표본평균 $\overline{x}$으로부터 양쪽으로 
$\pm 1.96 \cdot SE$만큼 떨어져 있는 표본분포 두 개를 생각해볼 수 있다.
<br>  
+측면에서 볼 때  
표본평균 $\overline{x}$은 표본분포 A의 중앙값 $\mu_{1}$으로부터 $+1.96 \cdot SE$만큼 떨어져 있는  
값으로서 표본 분포 A상에서 그 값보다 크거나 같은 값이 나올 확률이 0.025에 해당하는 경계값에 해당한다.  
정규분포에서 오른쪽 꼬리부분의 면적이 0.025가 되게 하는 경계값이 중앙값으로부터 표본오차SE 단위로  
1.96만큼 떨어져 있는 값이기 때문이다. 반대의 -경우도 같은 논리가 적용된다.
<br>    
![이미지](https://github.com/shina1221/shina1221.github.io/blob/main/_posts/%EB%8F%84%EC%84%9C/%EB%B9%84%EC%A0%84%EA%B3%B5%EC%9E%90%EB%A5%BC%20%EC%9C%84%ED%95%9C%20%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A0/img/%EC%8B%A0%EB%A2%B0%EA%B5%AC%EA%B0%84_%EC%A7%81%EA%B4%80%EC%A0%81_%EC%9D%B4%EC%9C%A0.jpg)  
<br>  
만약 표본분포 A의 중앙값 $\mu_{1}$이 더 작은 값을 가진다면   
결과적으로 오른쪽 고리부분의 면적이 0.025가 되게하는 경계값도 왼쪽으로 이동할 것이다.  
($\overline{x}$는 그 위치 그대로다.) 그 결과 연구자가 뽑은 표본평균 $\overline{x}$는 새롭게  
이동한 표본분포상에서 오른쪽 꼬리부분의 면적이 0.025가 되게 하는 경계값도 더 왼쪽으로 이동할 것이다.  
이런 변화를 개념적으로 보면 새로운 표본평균의 표본분포 A에서 무작위로 하나를 뽑았을 때  
그것이 현재 연구자의 손에 들려 있는 표본평균값 $\overline{x}$와 같거나 더 클 확률은  
0.025보다 더 작아진다는 의미다. 따라서 표본분포 A의 중앙값이 $\mu_{1}$보다 왼쪽에 속한 값일 수 있는  
가능성은 연구자가 받아들일 수 없으며 그래서 현재의 $\mu_{1}$이 연구자가 받아들일 수 있는 하한  
경계값이 된다. 
반대의 경우도 같은 논리를 적용해 연구자는 95%의 신뢰수준에서 $\overline{x}$의 표본분포의 중앙값  
즉 표본 표본평균의 기대값이 $\mu_{1}$보다 작거나 $\mu_{2}$보다 크다고 볼 수 없다는 결론에 도달한다.
<br>  
가설검증: 연구자가 가설의 형태로 설정한 모집단 모수 관련 주장이 실증적으로 타당한지 여부를 표본데이터를 활용해 검증한다.  
가설검증은 점추정, 구간추정과는 다르게 두가지 추정은 연구자의 주장 없이 모집단 모수에 대한 추정치를 구하는데 반해,  
가설검증은 연구자가 모집단 모수에 대해 갖고 있는 어떤 주장이 통계적으로 옳다고 할 수 있는지를 검증한다.
<br>  
참고 출처:   
https://www.datadata.link/qa47/  
https://angeloyeo.github.io/2020/02/12/standard_error.html  
https://velog.io/@ljs7463/%EA%B8%B0%EC%B4%88%ED%86%B5%EA%B3%84-8-%ED%91%9C%EC%A4%80%EC%98%A4%EC%B0%A8-%EC%99%80-%ED%91%9C%EC%A4%80%ED%8E%B8%EC%B0%A8-%EC%B0%A8%EC%9D%B4  
https://m.blog.naver.com/jieun0441/220651200311  


  
