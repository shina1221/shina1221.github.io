---
layout: post
title: 다중비교   
date: 2023-09-01 19:21:23 +0900
category: statistics 
use_math: true
---
# 비전공자를 위한 통계방법론    
> 쌍대비교를 통한 검증의 문제점       

기존에 세개 이상의 모집단 평균이 모두 같지는 않을 것이다 라는 가설을 기반으로 분산분석을 진행했다.
<br>  
분산분석 대신 모집단들을 두 개씩 쌍을 지어 그들 평균값 사이에 한 쌍에서라도 유의한  
차이가 존재하는 것으로 나오면 해당 가설을 입증했다고 할 수도 있지 않은가?  
하지만 연구자가 설정한 유의수준 a에서 임의의 두 모집단 평균 사이에 통계적으로 유의한  
차이가 존재하는 것으로 나왔어도 그것을 근거로 원래의 가설을 동일한 유의수준 a에서  
입증했다고 말할 수 없다.
<br>  
3개의 모집단 A,B,C의 평균이 모두 같지는 않을 것이다. 라는 가설을 $\alpha=0.05$수준에서  
검증하는 상황을 생각해본다.  
세 모집단을 두 개씩 쌍을 지어 각 쌍의 평균값이 다른지 여부를 검증할 경우  
대립가설1: A와 B 집단은 평균이 다르다.  
대립가설2: A와 C 집단은 평균이 다르다.  
대립가설3: B와 C 집단은 평균이 다르다.  
이렇게 세가지 쌍을 생각해볼 수 있다.
<br>  
**가설검증에서 유의수준을 $\alpha=0.05$로 설정한다면 이는 각 귀무가설이 옳았음에도**  
**귀무가설을 잘못 기각할 수 있는 제 1종 오류를 범할 수 있는 확률을 0.05까지**  
**허용한다는 것이다.** 이는 제 1종 오류를 범하지 않을 확률이 0.95가 된다는 것이다.
<br>  
개별 쌍들을 각각 비교하는 세 개의 가설검증을 할 때 이 중 하나의 케이스에서라도  
제 1종 오류를 범하지 않을 확률은 세 개의 가설검증 모두에서 제 1종 오류를 범하지  
않을 확률로 0.95*0.95*0.95=0.8574가 될 것이다.  
따라서 확률적으로 세 개의 가설검증 중 단 하나라도 제 1종 오류를 범할 확률은  
(1-0.8574)0.1462가 될 것이다.  
따라서 원래 기준으로 잡았던 유의수준인 0.05보다 커져 제 1종 오류를 범할 수 있는  
유의 수준은 급격하게 커진다. 때문에 분산분석 대신 두 개씩 쌍을 지어 평균이 동일한지  
검증하는 것은 옳지 않은 방법이 된다.
<br>  
따라서 세 개 이상의 모집단 평균이 특정한 유의수준에서 다르다고 할 수 있는지 여부를  
검증할 때에는 최우선적으로 분산분석(ANOVA)를 통해 귀무가설의 기각여부를 채택하는  
것이 옳다.
<br>  

> 모집단 두 개씩 상을 지어 비교하는 방법  

개별쌍에 대한 가설검증을 시행할 때 적용하는 유의수준을 비교 쌍의 수를 고려해  
축소조정해야 하는데 이때 **Bonferroni** 조정방식을 사용한다.  
이 방식은 연구자가 섲정한 유의수준을 모든 비교 가능한 쌍의 수로 나눠 얻은 값을  
Bonferroni 조정 $\alpha$값으로 설정해 개별 쌍에 대한 가설 검증을 실시한다.  
**ex) 모집단이 3개일 경우 Bonferroni 조정 $\alpha$값은 0.05/3=0.017이 된다.**  
따라서 세 쌍의 모집단 평균차에 관한 가설검증을 실시해 그 중 하나라도  
귀무가설을 기각하고 대립가설을 채택하는 결과가 나오면 이에 근거해  
모든 모집단에 대해 평균이 같지 않다는 대립가설을 $\alpha=0.05$수준에서 채택할  
수 있게 된다.
<br>  
한편 분산분석을 통해 본래의 대립가설을 채택할 근거를 확보하게 되면  
어느 모집단과 어느 모집단 사이에 통계적으로 유의한 평균차가 존재하는지 비교하는  
**다중비교 검증**을 하게 된다.  
다중비교 검증은 여러개의 모집단들 중에서 두 개의 모집단 씩 쌍을 지어 그 모집단들  
사이에 평균차가 존재하는지 여부를 검증하는 것으로 조합이 가능한 모든 모집단 쌍에  
대해 평균값을 비교해 검증하는 것이다.  
이에 **Fisher의 최소유의차(LSD: Least Significant Difference)검증법**이 사용된다.  
이 방법은 주로 복수의 모집단들을 평균차가 인정되는 모집단들과 평균차가 인정되지 않는  
모집단들로 분류할 목적으로 사용된다.
<br>  

> Fisher의 최소유의차(LSD) 검증법  

복수의 모집단 사이에 평균차가 존재한다고 할 수 있는지 여부를 검증하는 과정에서  
분산분석(ANOVA)을 통해 본래의 귀무가설을 기각하고 대립가설을 채택했다고 하자.  
다음 단계는 어느 모집단 사이에 평균차가 존재하는지 판정하는 것이다.  
**$LSD = t_{\alpha/2}\sqrt{MSE(\frac{1}{n_A}+\frac{1}{n_B})}$**
<br>     
**두 모집단에서 각 표본을 추출해 구한 표본평균차(![식1](https://latex.codecogs.com/svg.image?\overline{x}_A-\overline{x}_B&space;))의**  
**절대값이 LSD보다 크면 $\alpha$수준에서 모집단 A와 B의 평균값 사이에 유의한 차이가**  
**존재한다고 판정한다.**  
MSE는 분산분석표에 나타나는 오차평균제곱합(MSE)로 분산분석에서 등분산을  
가정하고 있는 모집단의 공통분산 $\sigma^2$에 대한 추정치이다.  
또한 $\sqrt{MSE(\frac{1}{n_A}+\frac{1}{n_B})}$는 두 표본평균의 평균차로  
($\overline{x}_A-\overline{x}_B$)의 표본오차(SE)이다.  
$t=\frac{\overline{x}_A-\overline{x}_B}{\sqrt{MSE(\frac{1}{n_A}+\frac{1}{n_B})}}$  
검증통계량을 통해 자유도 $(n_A+n_B-2)$인 t분포상의 기각영역 경계값 $t_{\alpha/2, n_A+n_B-2}$와 비교해 기각여부를 결정한다.
<br>  
*피셔의 LSD
<br>  
실제 사례: 교육 연구
<br>  
가정: 한 교육 연구에서 세 가지 다른 학습 방법을 비교하는 케이스가 있다.  
학습 방법 A, B, 그리고 C에 대한 성적 데이터를 얻었다고 한다.
<br>  
데이터 수집:
학습 방법 A, B, C에 대해 성적을 측정하고, 각각의 그룹에 해당하는 평균과 표준편차를 계산한다.
<br>  
등분산성 확인:
등분산성을 확인하기 위해 Levene의 등분산 검정 등을 수행한다.  
등분산성이 확인되면, 피셔의 LSD를 적용할 수 있다.
<br>  
ANOVA 수행:
일원분산분석(ANOVA)를 사용하여 세 그룹 간의 평균 차이가 통계적으로 유의미한지 확인한다.
<br>  
피셔의 LSD 적용:
ANOVA에서 통계적으로 유의미한 차이가 확인되었다면, 피셔의 LSD를 사용하여 어떤 그룹 간에 차이가 있는지를 식별한다.
예를 들어, A 그룹과 B 그룹 간에 유의미한 차이가 있다면, 피셔의 LSD를 사용해 어떤 학습 방법이 다른 것과 다르게 평균 성적에 영향을 미치는지를 확인할 수 있다.
<br>  
결과 해석:
피셔의 LSD를 통해 특정 그룹 간에 유의미한 차이가 있다면, 해당 그룹에서 사용된 학습 방법이 다른 그룹과 유의미하게 다른 성적을 가져왔다고 결론지을 수 있다.

참고 출처:  
ChatGPT  



