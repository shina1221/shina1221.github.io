---
layout: post
title: 실험설계와 분산분석 
date: 2023-08-31 19:21:23 +0900
category: statistics 
use_math: true
---
# 비전공자를 위한 통계방법론    
> 실험설계와 분산분석    

실증연구  
-실험에 의존한 연구  
-관찰에 의존한 연구
<br>  
실험에 의존한 연구  
연구자가 탐구하고자 하는 핵심 독립변수(분산분석에서는 요인(factor)이라고 함.)를  
직접 관리하고 조작해 다른 변수들의 영향이 끼어들 수 없도록 통제할 수 있다.
<br>  
ex) 대립가설: 금전적 인센티브가 사람들의 업무의욕 증진에 긍정적 영향을 미칠 것이다.
<br>  
방법1. 직장에 근무하고 있는 사람들을 표본으로 추출해 그 사람들을 대상으로 금전적  
인센티브를 얼마나 받았는지, 그리고 그들의 업무의욕이 어느 정도인지, 그들의 업무의욕이  
어느정도인지 설문을 통해 측정한 뒤 금전적 인센티브와 업무의욕 사이에 통계적으로  
유의한지 검증한다.  
이 방법은 관찰에 의존한 관찰연구 혹은 현장연구로  
이 방법은 금전적 인센티브 외에도 업무의욕에 영향을 미칠 만한 다양한 변수들이  
개개인에게 서로 다르게 영향을 미칠 수 있기 때문에 그런 모든 변수들의 영향력을  
통제한 뒤 금전적 인센티브만의 순수한 효과를 추출하기 어렵다.
<br>  
방법2. 실험에 참가할 사람들의 업무의욕을 볼 수 있는 과업을 설계하고,  
실험참가자들을 모집해 표본을 확보한다. 이어서 무작위로 실험참가자들을 업무성과와  
연동해 지불할 인센티브의 강도를 기준으로 두세그룹(인센티브 없음 그룹,  
중간정도의 인센티브 그룹, 강한 인센티브 그룹)으로 나눠 배정하고 각 그룹에  
배정된 실험참가자들에게는 해당 그룹에 적용될 인센티브 제공 방식에 대해 설명한다.  
*차이점:연구자가 실험참가자들을 특정 요인을 기준으로 구분한 그룹들에 무작위로 배정할  
수 있다는 점이 실험연구와 다르다.  
실험참가자들이 과업을 수행하게 한 뒤 일정 시점에서 그들의 과업수행 의욕을 측정한다.  
실험연구의 특성상 실험참가자들을 무작위로 서로 다른 조건을 갖춘 그룹에 배정해  
통계적으로 모든 그룹이 각각에 적용되는 인센티브 강도 이외의 변수들에서는 차이가  
없다고 말할 수 있다.  
**실험설계에서는 요인의 강도를 기준으로 그룹을 나눠 그룹간 요인의 강도 차이가**  
**적정한지 여부를 체크해야 하는데, 그것을 조작적합성 체크라고 한다.**  
또한 인과관계를 규명하기 수월하다.
<br>  

> 일원분산분석(one way ANOVA)  

ex) 3개 반(A반, B반, C반)의 영어점수 비교
한가지 요인(ex.학년 등)을 기준으로 모집단을 구분하고 각 모집단으로부터 무작위로  
추출된 표본에 근거해 모집단들의 평균값들 사이에 유의한 수준의 차이가 존재한다고 할 수 있는지 여부를 검증하는 방법이다.  
한가지 요인에 따라 k개의 집단으로 구분되고 그렇게 구분된 k개의 모집단 평균값들이  
서로 다르다고 할 수 있는지 여부를 검증해야 할 상황을 가정하면 k개의 개별 모집단으로부터  
각각 독립적으로 표본을 추출해 해당 가설을 검증하게 될 것이다.  
대립가설: k개 모집단의 평균값이 모두 같지는 않을 것이다.  
검증통계량 F(표본간분산/표본내분산)가 경계값보다 크거나 같으면, 유의확률 p값이 
유의수준 a보다 작거나 같으면 귀무가설을 기각하고 대립가설을 채택한다.  
*주의)  
분산분석은 점추정이나 구간추정의 양식으로 모집단 모수의 값을 추정하기보다  
가설검증의 형식으로 복수의 모집단 평균들 사이에 유의한 차이가 존재한다고 볼 수 있는지  
여부를 판정하는데 사용한다.
<br>  

> 이원분산분석  

ex) 학년과 성별에 따른 국어점수 비교
두가지 요인(요인 A와 요인 B)에 의해 모집단을 구분하고, 각 모집단으로부터 무작위로  
추출된 표본에 근거해 모집단들 사이에 유의미한 차이가 있는지 검증하다고 할 때 
비교대상 모집단은 요인 A를 기준으로 구분해볼 수도 있다.(이런 경우 요인 A를 기준으로  
일원분산분석 적용 가능), 요인 B를 기준으로 구분해 볼 수도 있다. 또한 요인 A와 B를  
동시게 적용해 구분해볼 수도 있다. 이런 경우 이원분산분석을 통해 요인 A와 요인 B사이의  
상호작용효과를 검증하게 된다.
<br>  

> 이원분산분석의 세가지 가설   

1. 요인 A를 기준으로 구분한 모집단들의 평균 사이에 유의한 수준의 차이가 존재하는가  
2. 요인 B를 기준으로 구분한 모집단들의 평균 사이에 유의한 수준의 차이가 존재하는가  
3. 요인 A와 요인 B를 동시에 적용해 구분한 모집단들의 평균 사이에 유의한 수준의   
  차이가 존재한다고 할 수 있는가  
ex) 학교에서 영어과목을 개설했다. 문법에 대한 학습법(요인 A)을 기준으로 3개 분반  
(a1, a2, a3)을 개설했고, 영어회화에 대한 상이한 학습법(요인 B)를 기준으로 3개의  
분반(b1, b2, b3)을 개설했다.  
모든 학생이 문법 분반 중에서 하나, 회화 분반 중에서 하나씩 택해 동시에 수강해야할 때  
모든 경우의 수는 $3*3$으로 9가지가 된다. 여기서 문법과 회화 각 학습법이 서로 다른 효과를  
내는지 검증하고 더 나아가 어느 문법 분반과 어느 회화 분반을 결합해 수강하는 것이  
영어실력향상에 차별화된 효과를 가져오는지 검증하고자 할때 다음과 같은 가설설정이 가능하다.  
가설1. 요인 A의 주요인효과에 관한 가설  
대립가설: 요인 A에 근거해 구분한 모집단들의 평균이 모두 같지는 않을 거이다.  
가설2. 요인 B의 주요인효과에 관한 가설  
대립가설: 요인 B에 근거해 구분한 모집단들의 평균이 모두 같지는 않을 것이다.  
가설3. 요인 A와 요인 B의 상호작용효과에 관한 가설  
대립가설: 요안 A와 요인 B에 근거해 구분한 모집단들의 평균이 모두 같지 않을 것이다.
<br>  
각 모집단 평균은 하점자를 통해 구분한다.  
ex) $\mu_1\cdot, \mu\cdot_1, \mu_{12}$  
ex) 요인 A에 따라 구분한 모집단 평균, 요인 B에 따라 구분한 모집단 평균,  
A와 B요인 모두를 감안해 구분한 모집단 평균  
$\mu_{32}$는 요인 A에 따른 구분에서는 $A_3$을 B에 따른 구분에서는 $B_2$를 택한  
학생들을 의미한다.
<br>  
($SSB_A$와 $SSB_B$는 임의로 만든 작성법이다.)  
$  SST = SSB_A + SSB_B + SSB_{AB} + SSW  $  
$(n_T-1) (j-1)   (k-1)  (j-1)(k-1) (n_T-j \cdot k)$
<br>  
요인A(3반) 요인B(3반)의 조합에 따라 생긴 9개의 분반에 각각 20명씩 무작위로 배치한 예를  
적용하면 SST의 자유도는 180(=$9*20$)-1 $SSB_A$의 자유도는 3-1=2,  
$SSB_B$의 자유도는 3-1=2, SSB_{AB}의 자유도는 (3-1)(3-1)=4 그리고  
SSW의 자유도는 171(=180-9)등이다.  
개별 제곱합을 각각에 해당하는 자유도로 나눠주면 표본간평균제곱합($SSB_A$와 $SSB_B$),  
상호작용평균제곱합($MSB_{AB}$), 표본내평균제곱합(MSW)을 구할 수 있다.  
각 검정통계치는 모두 F분포를 따른다.  
세가지 가설 각 귀무가설 기각여부는 각 검증통계치($F_A$, $F_B$, $F_{AB}$)가 기각영역 경계값인 $F_{a, df_1, df_2}$보다  
크거나 같으면 해당 귀무가설을 기각하고 대립가설을 채택한다.  
여기서 df_1은 분자의 자유도, df_2는 분모의 자유도를 가리킨다.
<br>  
![이원분산분석 결과표](https://github.com/shina1221/shina1221.github.io/blob/main/_posts/%EB%8F%84%EC%84%9C/%EB%B9%84%EC%A0%84%EA%B3%B5%EC%9E%90%EB%A5%BC%20%EC%9C%84%ED%95%9C%20%ED%86%B5%EA%B3%84%EB%B0%A9%EB%B2%95%EB%A1%A0/img/%EC%9D%B4%EC%9B%90%EB%B6%84%EC%82%B0%EB%B6%84%EC%84%9D%20%EA%B2%B0%EA%B3%BC%ED%91%9C.jpg)
<br>  
요인 A나 B에 따라 개별적으로 일원분산분석을 실시하는 대신 이원분산분석을 실시하는 가장  
중요한 목적은 요인 A와 요인 B 사이에 상호작용효과가 있는지를 검증하는데 있다.  
상호작용효과란 개별 개체들의 y값에 미치는 요인 A의 효과 크기가 요인 B의 수준이  
달라짐에 따라 다르게 나타날 때 일컫는 효과를 가리킨다.  
앞서 보았던 영어 과목의 학습효과에 관한 예를 가지고 봤을 시 
회화에 관한 학습법 중 특정학습법 $B_2$ 문법에 대한 학습법 $A_1, A_2, A_3$ 중  
어느것과 함께 수강하느냐에 따라 그 학습효과가 달리 나타난다면  
회화 학습법과 문법학습법 사이에 상호작용효과가 존재한다고 말할 수 있다.  

*스튜던트 t분포, 카이제곱과 F분포의 차이  
스튜던트 t분포, 카이제곱 분포, F분포는 모두 정규분포의 통계량 분포의 일종이다.  
선형회귀분석에서 이 통계량 분포들은 각각 다음 값에 대한 확률모형으로 사용된다.  
-스튜던트 t분포: 추정된 가중치에 대한 확률 분포  
-카이제곱 분포: 오차 제곱합에 대한 확률분포  
-F분포: 비교 대상이 되는 선형모형의 오차 제곱합에 대한 비율의 확률 분포  
<br>  
분산은 단순히 변수의 퍼짐 정도를 나타내는 것만이 아니라 비교의 신뢰성을 표현하기도 한다.  
두 집단의 평균에 큰 차이가 없어도 해당 평균의 분산이 크다면 신뢰하기 힘들다.  
A라는 분산과 B라는 분산이 있을 때, 비교를 통해 더 큰 확장성을 가진 분산을 알 수 있다.  
이런 분산을 측정하는 도구로 제곱합 구조를 사용한다.    
분산은 어떤 값을 기준으로 각 관찰값들이 그 기준값과 얼만큼 떨어져 있는지 평가하는 방식으로 측정하게 되는데,  
대부분의 경우 평균을 사용하게 된다.  
그렇지만 단순히 평균과 관찰값들의 거리를 이용하면 그 합이 0이 되어 의미가 없어지기 때문이다.  
따라서 기준값과의 거리의 제곱을 이용한다.  
그렇기 때문에 분산은 양의 값으로만 나온다.
<br>  
두 집단의 분산을 비교하는 방법으로 두 분산의 차이를 사용하면 안된다.  
비교하려는 집단의 집단의 단위가 다를 수 있고 각 집단의 수를 반영해줘야 하기 때문이다.  
집단의 자료 수가 많을수록 제곱합이 더 커지는 구조라는 것을 알아야한다.
<br>  
**-분산의 단위와 자료 수를 반영할 수 있도록 고안된 분포가 카이제곱 분포**  
**-카이제곱 분포들의 비(ratio)가 따르는 분포가 F분포이다.**
<br>  
카이제곱들의 비는 두 분산을 비교하기 위해 사용되는 것으로 자료 수와 관련된 자유도가 반영된다.  
f분포는 두 모분산의 비율에 대한 추정 등에 사용되고 주로 분산분석(ANOVA)에서 사용하며 그룹 간 및 그룹 내의 분산 차이를 비교하는데 사용된다.  
카이제곱 분포는 주로 하나의 변수의 분산이나 두 변수 간 독립셩 검정, 분산 검정에 사용된다.  
<br>  
참고 출처:  
[데이터 사이언스 스쿨](https://datascienceschool.net/02%20mathematics/08.05%20%EC%8A%A4%ED%8A%9C%EB%8D%98%ED%8A%B8%20t%EB%B6%84%ED%8F%AC%2C%20%EC%B9%B4%EC%9D%B4%EC%A0%9C%EA%B3%B1%EB%B6%84%ED%8F%AC%2C%20F%EB%B6%84%ED%8F%AC.html)  
[Must Learning with R](https://wikidocs.net/34010)  
OpenAI  