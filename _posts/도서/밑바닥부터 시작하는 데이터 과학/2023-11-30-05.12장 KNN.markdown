---
layout: post
title: 12장
date: 2023-11-30 19:20:23 +0900
category: ML 
use_math: true
---
# 밑바닥부터 시작하는 데이터 과학  

> 모델  

모델이 필요로 하는 것  
-거리를 재는 방법  
-서로 가까운 점들은 유사하다는 가정
<br>  
보통은 데이터에 내재된 패턴을 찾기 위해 데이터셋 전체를 봐야하지만 knn은 궁금한 점  
주변에 있는 것만 보기때문에 데이터를 많이 뒤지지 않아도 된다.  
knn은 특정 현상의 원인을 파악하는데 왜 그렇게 되었는지 설명하기가 힘들어  
큰 도움이 되지 않는다.  
새로운 데이터 포인트를 분류하고 싶다면 먼저 k개의 가장 가까운 포인트를 찾고,  
찾아낸 포인트들의 레이블을 보고 다수결로 새로운 데이터 포인트의 레이블을 정할 수 있다.
<br>  
**차원의 저주**  
knn은 차원의 저주라는 것 때문에 고차원에서 문제가 생긴다. 
이는 데이터가 고차원이라는 것은 다루는 공간이 매우 크다는 것을 의미한다.  
그 때문에 데이터 포인트들은 서로 근접하지 않게된다.
<br>  
![차원의 저주](https://github.com/shina1221/shina1221.github.io/blob/main/_posts/%EB%8F%84%EC%84%9C/%EB%B0%91%EB%B0%94%EB%8B%A5%EB%B6%80%ED%84%B0%20%EC%8B%9C%EC%9E%91%ED%95%98%EB%8A%94%20%EB%8D%B0%EC%9D%B4%ED%84%B0%20%EA%B3%BC%ED%95%99/img/%EC%B0%A8%EC%9B%90%EC%9D%98%20%EC%A0%80%EC%A3%BC.jpg?raw=true)  
차원이 증가할수록 점들 간 평균 거리도 증가하지만 더 큰 문제는 최근접거리와 평균 거리의 비율이다.
<br>  
![다시 돌아온 차원의 저주](https://github.com/shina1221/shina1221.github.io/blob/main/_posts/%EB%8F%84%EC%84%9C/%EB%B0%91%EB%B0%94%EB%8B%A5%EB%B6%80%ED%84%B0%20%EC%8B%9C%EC%9E%91%ED%95%98%EB%8A%94%20%EB%8D%B0%EC%9D%B4%ED%84%B0%20%EA%B3%BC%ED%95%99/img/%EB%8B%A4%EC%8B%9C%20%EC%B0%BE%EC%95%84%EC%98%A8%20%EC%B0%A8%EC%9B%90%EC%9D%98%20%EC%A0%80%EC%A3%BC.jpg?raw=true)   
저차원에서는 근접이웃들이 평균 거리에 비해 월등히 가깝다.  
하지만 두 점이 가깝다고 하려면 모든 차원에 대해 가까워야 하기 때문에 차원이 추가된다는 것은  
(그것이 노이즈라고 해도) 두 점이 가까울 수 있는 가능성이 현저히 줄어든다는 것을 의미한다.  
즉 **고차원일 때에는 근접 이웃들이 평균 거리와 큰 차이가 나지 않게되고,**  
**때문에 가깝다는 것이 별 의미를 가지지 않게된다.**  
(데이터에 뚜렷한 구조가 있어서 고차원임에도 저차원의 특성을 가지지 않는한)
<br>  
고차원의 문제를 바라볼 수 있는 또 다른 관점은 공간의 성김(sparse)이다.  
0과 1 사이에서 50개의 점을 임의로 고르면 단위 공간을 제법 채울 수 있다.  
하지만 차원이 올라가면서 같은 점을 찍더라도 단위 공간을 덜 채우게 된다.  
**차원이 높아질수록 점들 사이의 거리가 멀어지고 빈 공간이 많아진다는 것이다.**  
데이터가 기하급수적으로 많지 않으면 고차원에서는 모든 점 사이의 거리가 멀어진다.  
그렇기 때문에 **고차원에서 knn을 이용하려면 먼저 차원축소를 하는 것이 좋을 것이다.**
<br>  
[추가참고 knn을 통한 파라미터 튜닝](https://tobigs.gitbook.io/tobigs/data-analysis/python-knn)
<br>  
참고출처:  
https://opentutorials.org/module/3653/22071  
https://opentutorials.org/module/3653/22994  
https://medium.com/@ivanreznikov/stop-using-the-same-image-in-bias-variance-trade-off-explanation-691997a94a54  
https://tobigs.gitbook.io/tobigs/data-analysis/undefined-2/python-2-4  